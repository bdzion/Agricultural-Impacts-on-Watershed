import pandas as pd

# Load the hourly flow data
file_path = r"C:\Users\mbodrudd\OneDrive - University of Guelph\Zion\Zion PhD study\ABCA\ZionAnalysis\NewAnalysisAug\FinalAnalysisAug20\Hourly_Flow_Data.csv"
hourly_flow_data = pd.read_csv(file_path)

# Convert the datetime column to datetime object
hourly_flow_data['datetime'] = pd.to_datetime(hourly_flow_data['datetime'], format='%d/%m/%Y %H:%M')

# Aggregate the hourly data into daily mean flow values
daily_flow_data = hourly_flow_data.resample('D', on='datetime').mean()

# Rename the column for clarity
daily_flow_data.rename(columns={'Value[cumec]': 'mean_daily_flow'}, inplace=True)

# Calculate the absolute day-to-day changes
daily_flow_data['day_to_day_change'] = daily_flow_data['mean_daily_flow'].diff().abs()

# Calculate the cumulative total discharge up to each day
daily_flow_data['cumulative_discharge'] = daily_flow_data['mean_daily_flow'].cumsum()

# Calculate the daily R-B Flashiness Index
daily_flow_data['daily_flashiness_index'] = daily_flow_data['day_to_day_change'] / daily_flow_data['cumulative_discharge']

# Drop the rows with NaN values (first row will have NaN due to diff operation)
daily_flashiness_data = daily_flow_data.dropna()

# Save the results to a CSV file
output_file_path = r"C:\Users\mbodrudd\OneDrive - University of Guelph\Zion\Zion PhD study\ABCA\ZionAnalysis\NewAnalysisAug\FinalAnalysisAug20\Daily_Flashiness_Index.csv"
daily_flashiness_data.to_csv(output_file_path)

print("Daily R-B Flashiness Index calculation complete. Output saved to:", output_file_path)
